if (not game:IsLoaded()) then
    game.Loaded:Wait()
end -- game loaded sanity check >~

--\\ Services
local Players = game:GetService('Players')
local RunService = game:GetService('RunService')
local Workspace = game:GetService('Workspace')
local Storage = game:GetService('ReplicatedStorage')
local InputService = game:GetService('UserInputService')

--\\ Variables
local Client = Players.LocalPlayer
local Camera = Workspace.CurrentCamera
local Remote = Storage:FindFirstChild('MainEvent')

local Target

--\\ Table & Modules
local Settings = {
    Enabled = true,
    FoV = { Visible = true, Size = 140 },
    FovThickness = 2
}

local DrawingCircle = Drawing.new('Circle')
do
    DrawingCircle.Visible = Settings.FoV.Visible
    DrawingCircle.Radius = Settings.FoV.Size
    DrawingCircle.Color = Color3.new(1, 1, 1) -- Change color to white
    DrawingCircle.Transparency = 0.5 -- Make it slightly transparent
    DrawingCircle.Filled = false -- Make it unfilled
    DrawingCircle.Thickness = Settings.FovThickness -- Make it thicker
end

--\\ Functions
local function UpdateFoV()
    DrawingCircle.Visible = Settings.FoV.Visible
    DrawingCircle.Radius = Settings.FoV.Size
    DrawingCircle.Position = Vector2.new(Camera.ViewportSize.X / 2, Camera.ViewportSize.Y / 2)
    DrawingCircle.Thickness = Settings.FovThickness
end

local function GetClosestPlayer(Radius)
    local Distance, Player = Radius

    for _, Value in pairs(Players:GetPlayers()) do
        if Value == Client then
            continue
        end

        local Character = Value.Character
        local RootPart = Character and Character:FindFirstChild('HumanoidRootPart')

        if not RootPart then
            continue
        end

        local Position, OnScreen = Camera:WorldToViewportPoint(RootPart.Position)
        local Magnitude = (Vector2.new(Position.X, Position.Y) - Vector2.new(Camera.ViewportSize.X / 2, Camera.ViewportSize.Y / 2)).Magnitude

        if Magnitude > Distance then
            continue
        end

        if OnScreen then
            Distance = Magnitude
            Player = Value
        end
    end

    return Player
end

local function RenderStepped()
    UpdateFoV()
    Target = GetClosestPlayer(Settings.FoV.Size)
end

--\\ Connections
RunService.RenderStepped:Connect(RenderStepped)

--\\ GUI
local Gui = Instance.new("ScreenGui")
Gui.Parent = game.Players.LocalPlayer.PlayerGui

local Frame = Instance.new("Frame")
Frame.Name = "C4NC$L3D"
Frame.Size = UDim2.new(0, 200, 0, 270)
Frame.Position = UDim2.new(0.5, -100, 0.5, -135)
Frame.BackgroundColor3 = Color3.fromRGB(34, 34, 34)
Frame.BorderSizePixel = 0
Frame.ZIndex = 2
Frame.Active = true
Frame.Draggable = true
Frame.Parent = Gui

local Title = Instance.new("TextLabel")
Title.Name = "Title"
Title.Text = "C4NC$L3D"
Title.Size = UDim2.new(1, 0, 0, 20)
Title.Position = UDim2.new(0, 0, 0, 0)
Title.BackgroundTransparency = 1
Title.Font = Enum.Font.GothamSemibold
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextSize = 14
Title.Parent = Frame

local FovLabel = Instance.new("TextLabel")
FovLabel.Name = "FovLabel"
FovLabel.Text = "FOV Size"
FovLabel.Size = UDim2.new(0.5, 0, 0, 20)
FovLabel.Position = UDim2.new(0, 10, 0, 30)
FovLabel.BackgroundTransparency = 1
FovLabel.Font = Enum.Font.Gotham
FovLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
FovLabel.TextSize = 14
FovLabel.Parent = Frame

local FovSlider = Instance.new("TextButton")
FovSlider.Name = "FovSlider"
FovSlider.Text = ""
FovSlider.Size = UDim2.new(0.7, 0, 0, 10)
FovSlider.Position = UDim2.new(0.15, 0, 0, 60)
FovSlider.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
FovSlider.BorderSizePixel = 0
FovSlider.AutoButtonColor = false
FovSlider.Parent = Frame

local FovBlock = Instance.new("Frame")
FovBlock.Name = "FovBlock"
FovBlock.Size = UDim2.new(0, 10, 0, 10)
FovBlock.Position = UDim2.new(0.5, -5, 0, 0)
FovBlock.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
FovBlock.BorderSizePixel = 0
FovBlock.Parent = FovSlider

local HideFovButton = Instance.new("TextButton")
HideFovButton.Name = "HideFovButton"
HideFovButton.Text = "Hide FOV"
HideFovButton.Size = UDim2.new(0.5, -5, 0, 20)
HideFovButton.Position = UDim2.new(0, 10, 0, 90)
HideFovButton.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
HideFovButton.BorderSizePixel = 0
HideFovButton.AutoButtonColor = false
HideFovButton.Font = Enum.Font.Gotham
HideFovButton.TextColor3 = Color3.fromRGB(0, 0, 0) -- Change text color to black
HideFovButton.TextSize = 14
HideFovButton.Parent = Frame

local ColorPickerButton = Instance.new("TextButton")
ColorPickerButton.Name = "ColorPickerButton"
ColorPickerButton.Text = "Color Picker"
ColorPickerButton.Size = UDim2.new(0.5, -5, 0, 20)
ColorPickerButton.Position = UDim2.new(0.5, 5, 0, 90)
ColorPickerButton.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
ColorPickerButton.BorderSizePixel = 0
ColorPickerButton.AutoButtonColor = false
ColorPickerButton.Font = Enum.Font.Gotham
ColorPickerButton.TextColor3 = Color3.fromRGB(0, 0, 0) -- Change text color to black
ColorPickerButton.TextSize = 14
ColorPickerButton.Parent = Frame

local BodyPartDropdown = Instance.new("TextButton")
BodyPartDropdown.Name = "BodyPartDropdown"
BodyPartDropdown.Text = "Upper Torso"
BodyPartDropdown.Size = UDim2.new(1, -20, 0, 20)
BodyPartDropdown.Position = UDim2.new(0, 10, 0, 120)
BodyPartDropdown.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
BodyPartDropdown.BorderSizePixel = 0
BodyPartDropdown.AutoButtonColor = false
BodyPartDropdown.Font = Enum.Font.Gotham
BodyPartDropdown.TextColor3 = Color3.fromRGB(0, 0, 0) -- Change text color to black
BodyPartDropdown.TextSize = 14
BodyPartDropdown.Parent = Frame

local AimbotToggle = Instance.new("TextButton")
AimbotToggle.Name = "AimbotToggle"
AimbotToggle.Text = "Aimbot: OFF"
AimbotToggle.Size = UDim2.new(1, -20, 0, 20)
AimbotToggle.Position = UDim2.new(0, 10, 0, 210)
AimbotToggle.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
AimbotToggle.BorderSizePixel = 0
AimbotToggle.AutoButtonColor = false
AimbotToggle.Font = Enum.Font.Gotham
AimbotToggle.TextColor3 = Color3.fromRGB(0, 0, 0) -- Change text color to black
AimbotToggle.TextSize = 14
AimbotToggle.Parent = Frame

local ResetSettingsButton = Instance.new("TextButton")
ResetSettingsButton.Name = "ResetSettingsButton"
ResetSettingsButton.Text = "Reset Settings"
ResetSettingsButton.Size = UDim2.new(1, -20, 0, 20)
ResetSettingsButton.Position = UDim2.new(0, 10, 0, 240)
ResetSettingsButton.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
ResetSettingsButton.BorderSizePixel = 0
ResetSettingsButton.AutoButtonColor = false
ResetSettingsButton.Font = Enum.Font.Gotham
ResetSettingsButton.TextColor3 = Color3.fromRGB(0, 0, 0) -- Change text color to black
ResetSettingsButton.TextSize = 14
ResetSettingsButton.Parent = Frame

local HitIndicator = Instance.new("TextLabel")
HitIndicator.Name = "HitIndicator"
HitIndicator.Text = ""
HitIndicator.Size = UDim2.new(1, 0, 0, 20)
HitIndicator.Position = UDim2.new(0, 0, 1, -20)
HitIndicator.BackgroundTransparency = 1
HitIndicator.Font = Enum.Font.Gotham
HitIndicator.TextColor3 = Color3.fromRGB(255, 255, 255)
HitIndicator.TextSize = 14
HitIndicator.Parent = Frame

-- GUI Functionality

FovSlider.MouseButton1Down:Connect(function()
    FovSlider.MouseMoved:Connect(function()
        local relativeX = (InputService:GetMouseLocation().X - FovSlider.AbsolutePosition.X) / FovSlider.AbsoluteSize.X
        local size = math.clamp(relativeX, 0, 1)
        Settings.FoV.Size = size * 200 -- Adjust the multiplier for max FOV size
        UpdateFoV()
    end)
    FovSlider.MouseButton1Up:Connect(function()
        FovSlider.MouseMoved:Disconnect()
    end)
end)

HideFovButton.MouseButton1Click:Connect(function()
    Settings.FoV.Visible = not Settings.FoV.Visible
    UpdateFoV()
end)

ColorPickerButton.MouseButton1Click:Connect(function()
    local ColorPicker = Instance.new("ColorPickerFrame")
    ColorPicker.Parent = Gui
    ColorPicker.Name = "ColorPicker"
    ColorPicker.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    ColorPicker.Position = UDim2.new(0.5, -125, 0.5, -125)
    ColorPicker.Size = UDim2.new(0, 250, 0, 250)
    ColorPicker.Visible = true
    ColorPicker.Parent = Gui

    ColorPicker.Color = DrawingCircle.Color
    ColorPicker.ColorChanged:Connect(function(color)
        DrawingCircle.Color = color
    end)
end)

local BodyPartOptions = {
    "Upper Torso",
    "Humanoid Root Part",
    "Lower Torso",
    "Head"
}

local CurrentBodyPartIndex = 1

BodyPartDropdown.MouseButton1Click:Connect(function()
    CurrentBodyPartIndex = CurrentBodyPartIndex % #BodyPartOptions + 1
    BodyPartDropdown.Text = BodyPartOptions[CurrentBodyPartIndex]
end)

local AimbotEnabled = false

AimbotToggle.MouseButton1Click:Connect(function()
    AimbotEnabled = not AimbotEnabled
    if AimbotEnabled then
        AimbotToggle.Text = "Aimbot: ON"
    else
        AimbotToggle.Text = "Aimbot: OFF"
    end
end)

ResetSettingsButton.MouseButton1Click:Connect(function()
    Settings.FoV.Size = 140
    Settings.FoV.Visible = true
    UpdateFoV()
    BodyPartDropdown.Text = "Upper Torso"
    AimbotEnabled = false
    AimbotToggle.Text = "Aimbot: OFF"
end)

local function GetBodyPart()
    return BodyPartOptions[CurrentBodyPartIndex]
end

local function UpdateHitIndicator(player, bodyPart)
    HitIndicator.Text = player.Name .. " | " .. bodyPart
    wait(3)
    HitIndicator.Text = ""
end

InputService.InputBegan:Connect(function(input)
    if input.KeyCode == Enum.KeyCode.V then
        if Client.Character and Client.Character:FindFirstChild("Humanoid") then
            if Client.Character.Humanoid.WalkSpeed == 100 then
                Client.Character.Humanoid.WalkSpeed = 16
            else
                Client.Character.Humanoid.WalkSpeed = 100
            end
        end
    end
end)

local function aimbotFire()
    if Target and Remote then
        Remote:FireServer("UpdateMousePos", Target.Character[GetBodyPart()].Position)
        UpdateHitIndicator(Target, GetBodyPart())
    end
end

RunService.Heartbeat:Connect(function()
    if AimbotEnabled then
        aimbotFire()
    end
end)

-- Draw spreading dots
local function DrawDots(circle, radius, segments)
    local angleIncrement = 2 * math.pi / segments
    for i = 1, segments do
        local angle = i * angleIncrement
        local x = circle.Position.X + math.cos(angle) * radius
        local y = circle.Position.Y + math.sin(angle) * radius
        circle:Add(Vector2.new(x, y))
    end
end

DrawDots(DrawingCircle, Settings.FoV.Size, 50) -- Adjust the last parameter for the density of dots
